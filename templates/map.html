{% extends 'base.html' %}

{% block head %}
	<style>
		html { height:100% }
		body { height: 100%; margin:0; padding:0 }
		.container { height:100% }
		#map-canvas {
	        height: 300px;
	        margin: 0px;
	        padding: 0px
      	}
    </style>
    <!-- Google Maps API -->
    <script src="https://maps.googleapis.com/maps/api/js?v=3.exp"></script>
{% endblock %}

{% block content %}
	<div id="map-canvas"></div>
{% endblock %}

{% block js_code %}
<script>
		var map;
		myLatLng = new google.maps.LatLng(37.788708799999995,-122.41170040000003)

		//initialize the map
		function initialize() {
			//var mapOptions defines the properties for the map
			var mapOptions = {
				zoom: 13,
				center: myLatLng
			};

			//create a map object w/parameters from mapOptions
			map = new google.maps.Map(document.getElementById('map-canvas'), mapOptions);

			//create a marker for user's current location 
			var marker=new google.maps.Marker({
	  			position:myLatLng,
	  			title: "My title"
	  		});
			//add the marker to the map by using setMap() method
			marker.setMap(map);

			$.getJSON("/map-bookmarks", function(response){
				var json = response;
				//loop through each of the json elements, get their lat + lng & create a marker for these
				$.each(json, function(key, data){
					var lat = data.lat
					var lng = data.lng 
					var myLatLng = new google.maps.LatLng(lat, lng);
					var marker = new google.maps.Marker({
						position: myLatLng,
						map: map
					}); //end of getJSON 
				marker.setMap(map);
				});
			});
		} //end initialize function
		
		//event listener to load the map when page is loaded
		google.maps.event.addDomListener(window, 'load', initialize);
    </script>

{% endblock %}
